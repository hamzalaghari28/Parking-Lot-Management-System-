<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Cryptocurrency Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            padding: 30px;
            background-color: #14171A;
            color: #CCD6F6;
            text-align: center;
        }

        h2 {
            font-size: 28px;
            margin-top: 50px;
            color: #64FFDA;
            margin-bottom: 20px;
        }

        .charts-row {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 40px;
        }

        .chart-container {
            width: 320px;
            max-width: 95vw;
            height: 320px;
            background-color: #1C2128;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
            padding: 20px;
            transition: box-shadow 0.3s ease-in-out;
            border: 1px solid #2E3742;
        }

        .chart-container:hover {
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
        }

        canvas {
            width: 100% !important;
            height: 100% !important;
        }
    </style>
</head>
<body>

    <h2>Cryptocurrency Dashboard (CoinGecko)</h2>

    <label for="chartSelector" style="color: #CCD6F6; font-size: 16px;">Select Chart:</label>
<select id="chartSelector" onchange="handleChartSelection()" style="margin-left: 10px; padding: 5px; border-radius: 6px;">
    <option value="all">All Charts</option>
    <option value="barChart">Bar Chart</option>
    <option value="lineChart">Line Chart</option>
    <option value="pieChart">Pie Chart</option>
    <option value="doughnutChart">Doughnut Chart</option>
    <option value="polarChart">Polar Area Chart</option>
</select>


    <div class="charts-row">
        <div class="chart-container">
            <canvas id="barChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="lineChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="pieChart"></canvas>
        </div>
    </div>

    <div class="charts-row">
        <div class="chart-container">
            <canvas id="doughnutChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="polarChart"></canvas>
        </div>
    </div>

    <script>
        const coingeckoApiUrl = 'https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=10&page=1&sparkline=false';

       const softColors = ['#64FFDA', '#F9CA24', '#33AFFF', '#C778DD', '#50FA7B', '#FF6B6B', '#A29BFE', '#FD79A8', '#55EFC4', '#E17055'];

       function handleChartSelection() {
    const selected = document.getElementById("chartSelector").value;
    const chartIds = ["barChart", "lineChart", "pieChart", "doughnutChart", "polarChart"];

    chartIds.forEach(id => {
        const container = document.getElementById(id).parentElement;
        if (selected === "all" || selected === id) {
            container.style.display = "block";
        } else {
            container.style.display = "none";
        }
    });
}

        async function fetchGeckoDataAndRenderCharts() {
            try {
                const response = await fetch(coingeckoApiUrl);

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(`CoinGecko API Error: ${response.status} - ${error?.error || 'Unknown Error'}`);
                }

                const data = await response.json();

                const coinSymbols = data.map(coin => coin.symbol.toUpperCase());
                const marketCaps = data.map(coin => coin.market_cap);
                const prices = data.map(coin => coin.current_price);
                const percentChanges24h = data.map(coin => coin.price_change_percentage_24h);

                // Bar Chart - Market Cap
                new Chart(document.getElementById('barChart'), {
                    type: 'bar',
                    data: {
                        labels: coinSymbols,
                        datasets: [{
                            label: 'Market Cap (USD)',
                            data: marketCaps,
                            backgroundColor: softColors.slice(0, coinSymbols.length),
                        }],
                    },
                    options: {
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: false,
                                ticks: {
                                    callback: function (value) {
                                        if (value >= 1000000000) {
                                            return '$' + (value / 1000000000).toFixed(2) + 'B';
                                        } else if (value >= 1000000) {
                                            return '$' + (value / 1000000).toFixed(2) + 'M';
                                        } else if (value >= 1000) {
                                            return '$' + (value / 1000).toFixed(2) + 'K';
                                        }
                                        return '$' + value?.toFixed(2);
                                    },
                                },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' } 
                            },
                            x: { grid: { color: 'rgba(255, 255, 255, 0.1)' } }
                        },
                        plugins: { legend: { position: 'bottom', labels: { color: '#CCD6F6' } }, tooltip: { backgroundColor: 'rgba(28, 33, 40, 0.8)', bodyColor: '#CCD6F6', titleColor: '#CCD6F6' } }
                    }
                });

                // Line Chart - Price
                new Chart(document.getElementById('lineChart'), {
                    type: 'line',
                    data: {
                        labels: coinSymbols,
                        datasets: [{
                            label: 'Price (USD)',
                            data: prices,
                            borderColor: softColors[1],
                            backgroundColor: 'rgba(249, 202, 36, 0.2)',
                            tension: 0.4,
                            fill: true,
                        }],
                    },
                    options: {
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: false,
                                ticks: {
                                    callback: function (value) {
                                        return '$' + value?.toFixed(2);
                                    },
                                    color: '#CCD6F6'
                                },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' }
                            },
                            x: { grid: { color: 'rgba(255, 255, 255, 0.1)' }, ticks: { color: '#CCD6F6' } }
                        },
                        plugins: { legend: { position: 'bottom', labels: { color: '#CCD6F6' } }, tooltip: { backgroundColor: 'rgba(28, 33, 40, 0.8)', bodyColor: '#CCD6F6', titleColor: '#CCD6F6' } }
                    }
                });

                // Pie Chart - 24h Percentage Change
                new Chart(document.getElementById('pieChart'), {
                    type: 'pie',
                    data: {
                        labels: coinSymbols,
                        datasets: [{
                            label: '24h Change (%)',
                            data: percentChanges24h,
                            backgroundColor: softColors.slice(0, coinSymbols.length), 
                            borderWidth: 0
                        }],
                    },
                    options: {
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { color: '#CCD6F6' }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(28, 33, 40, 0.8)',
                                bodyColor: '#CCD6F6',
                                titleColor: '#CCD6F6',
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        if (context.parsed !== null) {
                                            label += ': ' + context.parsed.toFixed(2) + '%';
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });

                // Doughnut Chart - Market Share
                const top3MarketCaps = marketCaps.slice(0, 3);
                const totalTop3Cap = top3MarketCaps.reduce((sum, cap) => sum + cap, 0);
                const doughnutData = top3MarketCaps.map(cap => (cap / totalTop3Cap) * 100);

                new Chart(document.getElementById('doughnutChart'), {
                    type: 'doughnut',
                    data: {
                        labels: coinSymbols.slice(0, 3),
                        datasets: [{
                            label: 'Market Share (%)',
                            data: doughnutData,
                            backgroundColor: [softColors[0], softColors[2], softColors[4]].slice(0, 3),
                            borderWidth: 0,
                        }],
                    },
                    options: {
                        maintainAspectRatio: false,
                        plugins: { legend: { position: 'bottom', labels: { color: '#CCD6F6' } }, tooltip: { backgroundColor: 'rgba(28, 33, 40, 0.8)', bodyColor: '#CCD6F6', titleColor: '#CCD6F6' } }
                    }
                });

                // Polar Area Chart - Relative Price
                const maxPrice = Math.max(...prices);
                const polarData = prices.map(price => (price / maxPrice) * 100);

                new Chart(document.getElementById('polarChart'), {
                    type: 'polarArea',
                    data: {
                        labels: coinSymbols,
                        datasets: [{
                            label: 'Relative Price (%)',
                            data: polarData,
                            backgroundColor: [softColors[0], softColors[1], softColors[2], softColors[3], softColors[4]].slice(0, coinSymbols.length),
                            borderWidth: 0,
                        }],
                    },
                    options: {
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                ticks: { display: false }
                            }
                        },
                        plugins: { legend: { position: 'bottom', labels: { color: '#CCD6F6' } }, tooltip: { backgroundColor: 'rgba(28, 33, 40, 0.8)', bodyColor: '#CCD6F6', titleColor: '#CCD6F6' } }
                    }
                });

            } catch (error) {
                console.error('Error fetching or rendering data from CoinGecko:', error);
            }
        }

        fetchGeckoDataAndRenderCharts();
    </script>
</body>
</html>